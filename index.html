<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>í­ê·„ ì„œë²„ ë„ê° ê²€ìƒ‰ê¸°</title>
  <meta name="description" content="í­ê·„ ì„œë²„ìš© ë„ê°/ì•„ì´í…œ ê²€ìƒ‰ê¸° â€“ GitHub Pagesì—ì„œ ë°”ë¡œ ë™ì‘" />
  <style>
    :root{
      --bg:#0b0f15; --layer:#101826; --ink:#e6edf3; --muted:#9aa4b2; --line:#223049; --brand:#60a5fa; --accent:#22d3ee; --warn:#f59e0b; --heart:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 400px at 10% -20%,#16233b 0%,transparent 55%),
                      radial-gradient(800px 300px at 90% -30%,#2a1f45 0%,transparent 55%),
                      linear-gradient(180deg,#0b0f15,#0e1522);
         color:var(--ink);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Helvetica,Arial}
    a{color:var(--accent);text-decoration:none}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    header{position:relative;padding:28px 16px 12px;border-bottom:1px solid #1a2436}
    .title{font-size:28px;font-weight:800;letter-spacing:-.02em}
    .subtitle{color:var(--muted)}

    .controls{position:sticky;top:0;z-index:10;background:#0b0f15cc;backdrop-filter:blur(10px);border-bottom:1px solid #1a2436}
    .controls .container{display:grid;gap:12px;grid-template-columns:1fr auto auto auto;align-items:center;padding:12px 16px}
    @media (max-width:900px){.controls .container{grid-template-columns:1fr 1fr;}}
    @media (max-width:520px){.controls .container{grid-template-columns:1fr;}}

    .search{display:flex;align-items:center;gap:8px;background:var(--layer);border:1px solid var(--line);border-radius:12px;padding:10px 12px}
    .search input{flex:1;border:0;background:transparent;color:var(--ink);outline:0}

    select, .btn{background:var(--layer);border:1px solid var(--line);color:var(--ink);border-radius:10px;padding:10px 12px}
    .btn{cursor:pointer}
    .btn.primary{background:var(--brand);border-color:transparent;color:#fff}

    .grid{display:grid;gap:14px;margin-top:16px;grid-template-columns:repeat(4,minmax(0,1fr))}
    @media (max-width:1000px){.grid{grid-template-columns:repeat(3,minmax(0,1fr))}}
    @media (max-width:720px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
    @media (max-width:460px){.grid{grid-template-columns:1fr}}

    .card{position:relative;background:var(--layer);border:1px solid var(--line);border-radius:16px;padding:14px;display:flex;flex-direction:column;gap:8px}
    .card h3{margin:0;font-size:18px}
    .muted{color:var(--muted)}
    .tag{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);padding:4px 8px;border-radius:999px;font-size:12px;color:var(--muted)}
    .row{display:flex;gap:8px;flex-wrap:wrap}

    .fav{position:absolute;right:10px;top:10px;border:0;background:#0e1522;border-radius:999px;padding:6px 8px;cursor:pointer;border:1px solid var(--line)}
    .fav.active{background:var(--heart);color:#fff;border-color:transparent}

    .toolbar{display:flex;align-items:center;gap:8px}
    .pagination{display:flex;gap:8px;justify-content:center;margin:16px 0}

    .empty{padding:28px;text-align:center;border:1px dashed var(--line);border-radius:12px;color:var(--muted)}
    .count{color:var(--muted);font-size:14px}

    footer{border-top:1px solid #1a2436;margin-top:18px}
    footer .container{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;padding:16px}
  </style>
</head>
<body>
  <header class="container">
    <div class="title">ğŸ§ í­ê·„ ì„œë²„ ë„ê° ê²€ìƒ‰ê¸°</div>
    <div class="subtitle">ì•„ì´í…œ/ìš”ë¦¬/ì¬ë£Œë¥¼ ë¹ ë¥´ê²Œ ì°¾ì•„ë³´ì„¸ìš”. </div>
  </header>

  <div class="controls">
    <div class="container">
      <div class="search"><span>ğŸ”</span><input id="q" placeholder="ì´ë¦„, íƒœê·¸, ì„¤ëª…ìœ¼ë¡œ ê²€ìƒ‰" autocomplete="off" /></div>
      <select id="cat">
        <option value="">ì „ì²´ ë¶„ë¥˜</option>
        <option>ìš”ë¦¬</option>
        <option>ì¬ë£Œ</option>
        <option>ë„êµ¬</option>
        <option>ê¸°íƒ€</option>
      </select>
      <select id="rar">
        <option value="">í¬ê·€ë„ ì „ì²´</option>
        <option>â˜…</option>
        <option>â˜…â˜…</option>
        <option>â˜…â˜…â˜…</option>
        <option>â˜…â˜…â˜…â˜…</option>
        <option>â˜…â˜…â˜…â˜…â˜…</option>
      </select>
      <select id="sort">
        <option value="name">ì´ë¦„ìˆœ</option>
        <option value="rarity">í¬ê·€ë„ ë†’ì€ìˆœ</option>
        <option value="recent">ìµœê·¼ ì¶”ê°€ìˆœ</option>
      </select>
    </div>
  </div>

  <main class="container">
    <div class="toolbar">
      <button class="btn" id="reset">í•„í„° ì´ˆê¸°í™”</button>
      <span class="count" id="count"></span>
      <span style="flex:1"></span>
      <button class="btn" id="exportFavs">ì¦ê²¨ì°¾ê¸° ë‚´ë³´ë‚´ê¸°</button>
      <input type="file" id="importFavs" style="display:none" accept="application/json" />
      <button class="btn" id="importFavsBtn">ê°€ì ¸ì˜¤ê¸°</button>
    </div>

    <div id="grid" class="grid"></div>
    <div id="empty" class="empty" style="display:none">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš”. ì² ìë¥¼ ë°”ê¿”ë³´ê±°ë‚˜ í•„í„°ë¥¼ ì¡°ì •í•´ë³´ì„¸ìš”.</div>
    <div class="pagination" id="pager"></div>
  </main>

  <footer>
    <div class="container">
      <div>Made for <b>í­ê·„ ì„œë²„</b> Â· ì •ì  HTML/JS Â· GitHub Pages í˜¸í™˜</div>
      <div><a href="#" id="share">í˜„ì¬ ê²€ìƒ‰ ê³µìœ </a></div>
    </div>
  </footer>

  <script>
    // ===== ë°ì´í„° ìƒ˜í”Œ =====
    // ì‹¤ì œ ì‚¬ìš© ì‹œ ì•„ë˜ DATA ë°°ì—´ì„ ì—¬ëŸ¬ë¶„ ì„œë²„ ë°ì´í„°ë¡œ êµì²´í•˜ì„¸ìš”.
    // í•„ë“œ: id(ê³ ìœ ), name, category, rarity(1~5), desc, tags[], sources[], addedAt(ISO)
    const DATA = [
      { id:'cook_001', name:'ê·¸ë¦°ë¸ ìƒëŸ¬ë“œ', category:'ìš”ë¦¬', rarity:3, desc:'ì‹ ì„ í•œ í—ˆë¸Œì™€ ì±„ì†Œë¡œ ë§Œë“  ìƒëŸ¬ë“œ', tags:['íšŒë³µ','ì´ˆë°˜ì¶”ì²œ'], sources:['ê·¸ë¦°ë¸ í‰ì›'], addedAt:'2025-01-01' },
      { id:'mat_002', name:'í­ê·„ ë•…ì½©', category:'ì¬ë£Œ', rarity:2, desc:'ê³ ì†Œí•œ í–¥ì´ ë‚˜ëŠ” íŠ¹ì‚° ê²¬ê³¼', tags:['ìš”ë¦¬ì¬ë£Œ'], sources:['í­ê·„ í•´ì•ˆ'], addedAt:'2025-01-04' },
      { id:'tool_003', name:'ì–¼ìŒ ì ˆë‹¨ê¸°', category:'ë„êµ¬', rarity:4, desc:'ë‘êº¼ìš´ ì–¼ìŒì„ ë¹ ë¥´ê²Œ ì ˆë‹¨', tags:['ì±„ì§‘','ëª¨í—˜'], sources:['ë¶ê·¹ ë™êµ´'], addedAt:'2025-01-07' },
      { id:'cook_004', name:'ë¹™í•˜ ìŠ¤íŠœ', category:'ìš”ë¦¬', rarity:5, desc:'í¬ê·€ í•´ì‚°ë¬¼ë¡œ ë“ì¸ ê¹Šì€ ë§›', tags:['ë²„í”„','ì²´ë ¥ì¦ê°€'], sources:['ë¹™í•˜ í˜¸ìˆ˜'], addedAt:'2025-01-10' },
      { id:'mat_005', name:'ì–¼ìŒê½ƒ', category:'ì¬ë£Œ', rarity:3, desc:'ì°¨ê°‘ê²Œ í”¼ëŠ” ì‹ ë¹„í•œ ê½ƒ', tags:['ì—°ê¸ˆ','ì¥ì‹'], sources:['ì„¤ì› ì´ˆì§€'], addedAt:'2025-01-11' },
      { id:'etc_006', name:'í­ëŒì´ ì¸í˜•', category:'ê¸°íƒ€', rarity:1, desc:'ê·€ì—¬ìš´ ë§ˆìŠ¤ì½”íŠ¸ êµ¿ì¦ˆ', tags:['ìˆ˜ì§‘'], sources:['ì´ë²¤íŠ¸ ìƒì '], addedAt:'2025-01-12' },
    ];

    // ===== ìœ í‹¸ =====
    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const norm = s => (s||'').toString().toLowerCase().replace(/\s+/g,'').normalize('NFKD');

    // URL <-> ìƒíƒœ ë™ê¸°í™”
    function readParams(){
      const p = new URLSearchParams(location.search);
      return {
        q: p.get('q')||'',
        cat: p.get('cat')||'',
        rar: p.get('rar')||'',
        sort: p.get('sort')||'name',
        page: parseInt(p.get('page')||'1',10)
      };
    }
    function writeParams(state){
      const p = new URLSearchParams();
      if (state.q) p.set('q', state.q);
      if (state.cat) p.set('cat', state.cat);
      if (state.rar) p.set('rar', state.rar);
      if (state.sort && state.sort!=='name') p.set('sort', state.sort);
      if (state.page && state.page>1) p.set('page', String(state.page));
      history.replaceState(null,'','?'+p.toString());
    }

    const PAGE_SIZE = 24;
    const favKey = 'penguin-favs-v1';
    const favs = new Set(JSON.parse(localStorage.getItem(favKey) || '[]'));

    function toggleFav(id){
      if (favs.has(id)) favs.delete(id); else favs.add(id);
      localStorage.setItem(favKey, JSON.stringify([...favs]));
      render();
    }

    function match(item, q){
      if (!q) return true;
      const nq = norm(q);
      return [item.name, item.desc, ...(item.tags||[]), ...(item.sources||[])]
        .some(v => norm(v).includes(nq));
    }

    function applyFilters(list, state){
      let out = list.filter(it => match(it, state.q));
      if (state.cat) out = out.filter(it => it.category === state.cat);
      if (state.rar) out = out.filter(it => String('â˜…'.repeat(it.rarity)) === state.rar);
      switch(state.sort){
        case 'rarity': out.sort((a,b)=> b.rarity - a.rarity || a.name.localeCompare(b.name)); break;
        case 'recent': out.sort((a,b)=> new Date(b.addedAt) - new Date(a.addedAt)); break;
        default: out.sort((a,b)=> a.name.localeCompare(b.name,'ko')); break;
      }
      return out;
    }

    function renderPager(total, page){
      const pages = Math.max(1, Math.ceil(total / PAGE_SIZE));
      const el = $('#pager'); el.innerHTML = '';
      if (pages <= 1) return;
      const btn = (p, label=p) => {
        const b = document.createElement('button');
        b.className='btn'; b.textContent=label; if (p===page) b.classList.add('primary');
        b.addEventListener('click', ()=>{state.page=p; writeParams(state); render();});
        return b;
      };
      el.appendChild(btn(Math.max(1,page-1),'ì´ì „'));
      for(let p=Math.max(1,page-2); p<=Math.min(pages,page+2); p++) el.appendChild(btn(p));
      el.appendChild(btn(Math.min(pages,page+1),'ë‹¤ìŒ'));
    }

    function star(n){ return 'â˜…'.repeat(n); }

    function card(item){
      const wrap = document.createElement('div');
      wrap.className = 'card';
      wrap.innerHTML = `
        <button class="fav ${favs.has(item.id)?'active':''}" title="ì¦ê²¨ì°¾ê¸°">
          ${favs.has(item.id)?'â™¥':'â™¡'}
        </button>
        <h3>${item.name}</h3>
        <div class="row">
          <span class="tag">${item.category}</span>
          <span class="tag">${star(item.rarity)}</span>
        </div>
        <div class="muted">${item.desc||''}</div>
        ${item.tags?.length? `<div class="row">${item.tags.map(t=>`<span class='tag'>#${t}</span>`).join('')}</div>`:''}
        ${item.sources?.length? `<div class="row">${item.sources.map(s=>`<span class='tag'>${s}</span>`).join('')}</div>`:''}
      `;
      wrap.querySelector('.fav').addEventListener('click', ()=> toggleFav(item.id));
      return wrap;
    }

    function render(){
      // controls -> state
      state.q = $('#q').value.trim();
      state.cat = $('#cat').value;
      state.rar = $('#rar').value;
      state.sort = $('#sort').value;

      const filtered = applyFilters(DATA, state);
      const total = filtered.length;

      // page bounds
      const pages = Math.max(1, Math.ceil(total / PAGE_SIZE));
      if (state.page>pages) state.page = pages;
      if (state.page<1) state.page = 1;

      // render count
      $('#count').textContent = `${total.toLocaleString()}ê°œ ê²°ê³¼` + (favs.size? ` Â· ì¦ê²¨ì°¾ê¸° ${favs.size}`:'');

      // slice
      const start = (state.page-1)*PAGE_SIZE;
      const visible = filtered.slice(start, start+PAGE_SIZE);

      // grid
      const grid = $('#grid'); grid.innerHTML='';
      visible.forEach(it => grid.appendChild(card(it)));

      // empty
      $('#empty').style.display = visible.length? 'none' : 'block';

      // pager
      renderPager(total, state.page);

      // URL sync
      writeParams(state);
    }

    // ===== ì´ˆê¸°í™” =====
    const state = readParams();
    // ì±„ìš°ê¸°
    $('#q').value = state.q; $('#cat').value = state.cat; $('#rar').value = state.rar; $('#sort').value = state.sort;

    // ì´ë²¤íŠ¸ ë°”ì¸ë”©(ì…ë ¥ ì¦‰ì‹œ ë°˜ì˜)
    $('#q').addEventListener('input', ()=>{ state.page=1; render(); });
    $('#cat').addEventListener('change', ()=>{ state.page=1; render(); });
    $('#rar').addEventListener('change', ()=>{ state.page=1; render(); });
    $('#sort').addEventListener('change', ()=>{ state.page=1; render(); });
    $('#reset').addEventListener('click', ()=>{
      $('#q').value=''; $('#cat').value=''; $('#rar').value=''; $('#sort').value='name'; state.page=1; render();
    });

    // ê³µìœ  ë§í¬
    $('#share').addEventListener('click', (e)=>{ e.preventDefault(); navigator.clipboard.writeText(location.href); alert('í˜„ì¬ ê²€ìƒ‰/í•„í„°ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!'); });

    // ì¦ê²¨ì°¾ê¸° export/import
    $('#exportFavs').addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify([...favs], null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='penguin-favs.json'; a.click(); URL.revokeObjectURL(url);
    });
    $('#importFavsBtn').addEventListener('click', ()=> $('#importFavs').click());
    $('#importFavs').addEventListener('change', async (e)=>{
      const file = e.target.files[0]; if (!file) return;
      const text = await file.text();
      try{ const arr = JSON.parse(text); localStorage.setItem(favKey, JSON.stringify(arr)); favs.clear(); arr.forEach(x=>favs.add(x)); render(); alert('ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ!'); }
      catch{ alert('JSON í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.'); }
    });

    // ìµœì´ˆ ë Œë”
    render();
  </script>
</body>
</html>
